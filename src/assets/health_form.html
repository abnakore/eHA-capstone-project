<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Health Record - HealthSnapshot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --color-blue: #1a4b8c;
            --color-light-blue: #e6f0fa;
            --color-white: #ffffff;
            --color-dark-gray: #333333;
            --color-medium-gray: #666666;
            --color-light-gray: #f5f5f5;
            --color-green: #2ecc71;
            --color-orange: #e67e22;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Inter', Roboto, sans-serif;
        }

        body {
            background-color: var(--color-light-gray);
            color: var(--color-dark-gray);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 250px;
            background-color: var(--color-white);
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            padding: 1.5rem 0;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 1.5rem 1.5rem;
            border-bottom: 1px solid var(--color-light-gray);
            margin-bottom: 1.5rem;
        }

        .logo-icon {
            background-color: var(--color-blue);
            color: var(--color-white);
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-weight: bold;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-blue);
        }

        .nav-links {
            flex: 1;
        }

        .nav-item {
            padding: 0.9rem 1.5rem;
            display: flex;
            align-items: center;
            color: var(--color-medium-gray);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover,
        .nav-item.active {
            background-color: var(--color-light-blue);
            color: var(--color-blue);
            border-left-color: var(--color-blue);
        }

        .nav-item i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        .user-profile {
            padding: 1.5rem;
            border-top: 1px solid var(--color-light-gray);
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--color-light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: var(--color-blue);
            font-weight: 600;
        }

        .user-info h4 {
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .user-info p {
            font-size: 0.8rem;
            color: var(--color-medium-gray);
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: auto;
        }

        .header {
            background-color: var(--color-white);
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .page-title h1 {
            color: var(--color-blue);
            font-size: 1.8rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .btn {
            padding: 0.7rem 1.2rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background-color: var(--color-blue);
            color: var(--color-white);
        }

        .btn-primary:hover {
            background-color: #153a6d;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--color-blue);
            color: var(--color-blue);
        }

        .btn-outline:hover {
            background-color: var(--color-light-blue);
        }

        /* Form Content */
        .form-content {
            padding: 2rem;
            flex: 1;
        }

        .form-container {
            background-color: var(--color-white);
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .form-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--color-light-gray);
        }

        .form-header h2 {
            color: var(--color-blue);
            margin-bottom: 0.5rem;
        }

        .form-header p {
            color: var(--color-medium-gray);
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.2rem;
            color: var(--color-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title i {
            font-size: 1rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--color-dark-gray);
        }

        .form-label.required:after {
            content: " *";
            color: #e74c3c;
        }

        .form-input,
        .form-select,
        .form-textarea {
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--color-blue);
            box-shadow: 0 0 0 3px rgba(26, 75, 140, 0.2);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-hint {
            font-size: 0.8rem;
            color: var(--color-medium-gray);
            margin-top: 0.3rem;
        }

        /* File Upload Styles */
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 6px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: var(--color-blue);
            background-color: var(--color-light-blue);
        }

        .file-upload i {
            font-size: 2rem;
            color: var(--color-medium-gray);
            margin-bottom: 1rem;
        }

        .file-upload p {
            color: var(--color-medium-gray);
            margin-bottom: 0.5rem;
        }

        .file-upload small {
            color: var(--color-medium-gray);
        }

        .file-input {
            display: none;
        }

        .file-preview {
            margin-top: 1rem;
            display: none;
        }

        .file-preview.active {
            display: block;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.8rem;
            background-color: var(--color-light-gray);
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .file-icon {
            color: var(--color-blue);
        }

        .file-name {
            font-weight: 500;
        }

        .file-remove {
            background: none;
            border: none;
            color: var(--color-medium-gray);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .file-remove:hover {
            color: #e74c3c;
        }

        /* Dynamic Form Sections */
        .dynamic-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .dynamic-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Form Actions */
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-light-gray);
        }

        /* Record Type Selector */
        .record-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .record-type-option {
            border: 2px solid var(--color-light-gray);
            border-radius: 8px;
            padding: 1.5rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .record-type-option:hover {
            border-color: var(--color-blue);
            background-color: var(--color-light-blue);
        }

        .record-type-option.selected {
            border-color: var(--color-blue);
            background-color: var(--color-light-blue);
        }

        .record-type-icon {
            font-size: 2rem;
            color: var(--color-blue);
            margin-bottom: 0.8rem;
        }

        .record-type-label {
            font-weight: 500;
            color: var(--color-dark-gray);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 70px;
            }

            .logo-text,
            .nav-text,
            .user-info {
                display: none;
            }

            .logo {
                justify-content: center;
                padding: 0 0.5rem 1.5rem;
            }

            .nav-item {
                justify-content: center;
                padding: 1rem 0.5rem;
            }

            .nav-item i {
                margin-right: 0;
            }

            .user-profile {
                justify-content: center;
                padding: 1rem 0.5rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                flex-direction: row;
                padding: 1rem;
            }

            .logo {
                padding: 0;
                margin-bottom: 0;
                border-bottom: none;
                margin-right: 1rem;
            }

            .nav-links {
                display: flex;
                flex: 1;
            }

            .nav-item {
                border-left: none;
                border-bottom: 3px solid transparent;
                flex-direction: column;
                padding: 0.5rem;
                font-size: 0.8rem;
            }

            .nav-item:hover,
            .nav-item.active {
                border-left: none;
                border-bottom-color: var(--color-blue);
            }

            .nav-item i {
                margin-right: 0;
                margin-bottom: 5px;
            }

            .user-profile {
                display: none;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .record-type-selector {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <div class="logo-icon">HS</div>
                <div class="logo-text">HealthSnapshot</div>
            </div>

            <div class="nav-links">
                <a href="dashboard.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="timeline.html" class="nav-item">
                    <i class="fas fa-history"></i>
                    <span class="nav-text">Timeline</span>
                </a>
                <a href="form.html" class="nav-item active">
                    <i class="fas fa-plus-circle"></i>
                    <span class="nav-text">Add Record</span>
                </a>
                <a href="documents.html" class="nav-item">
                    <i class="fas fa-file-medical"></i>
                    <span class="nav-text">Documents</span>
                </a>
                <a href="profile.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span class="nav-text">Settings</span>
                </a>
            </div>

            <div class="user-profile">
                <div class="user-avatar">JD</div>
                <div class="user-info">
                    <h4>John Doe</h4>
                    <p>Patient</p>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="page-title">
                    <h1>Add Health Record</h1>
                </div>

                <div class="header-actions">
                    <button class="btn btn-outline" id="cancelBtn">
                        <i class="fas fa-times"></i>
                        Cancel
                    </button>
                </div>
            </div>

            <!-- Form Content -->
            <div class="form-content">
                <div class="form-container">
                    <div class="form-header">
                        <h2>Create New Health Record</h2>
                        <p>Fill out the form below to add a new health record to your timeline.</p>
                    </div>

                    <form id="healthRecordForm">
                        <!-- Record Type Selection -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-tag"></i>
                                Record Type
                            </h3>

                            <div class="record-type-selector">
                                <div class="record-type-option" data-type="Visit">
                                    <div class="record-type-icon">
                                        <i class="fas fa-user-md"></i>
                                    </div>
                                    <div class="record-type-label">Visit</div>
                                </div>
                                <div class="record-type-option" data-type="Medication">
                                    <div class="record-type-icon">
                                        <i class="fas fa-pills"></i>
                                    </div>
                                    <div class="record-type-label">Medication</div>
                                </div>
                                <div class="record-type-option" data-type="Lab">
                                    <div class="record-type-icon">
                                        <i class="fas fa-flask"></i>
                                    </div>
                                    <div class="record-type-label">Lab</div>
                                </div>
                                <div class="record-type-option" data-type="Imaging">
                                    <div class="record-type-icon">
                                        <i class="fas fa-x-ray"></i>
                                    </div>
                                    <div class="record-type-label">Imaging</div>
                                </div>
                                <div class="record-type-option" data-type="Allergy_Report">
                                    <div class="record-type-icon">
                                        <i class="fas fa-allergies"></i>
                                    </div>
                                    <div class="record-type-label">Allergy</div>
                                </div>
                                <div class="record-type-option" data-type="Condition">
                                    <div class="record-type-icon">
                                        <i class="fas fa-stethoscope"></i>
                                    </div>
                                    <div class="record-type-label">Condition</div>
                                </div>
                            </div>

                            <input type="hidden" id="record_type" name="record_type" required>
                        </div>

                        <!-- Common Fields -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-info-circle"></i>
                                Basic Information
                            </h3>

                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="event_date" class="form-label required">Event Date</label>
                                    <input type="date" id="event_date" name="event_date" class="form-input" required>
                                </div>

                                <div class="form-group">
                                    <label for="title" class="form-label required">Title</label>
                                    <input type="text" id="title" name="title" class="form-input"
                                        placeholder="e.g., Annual Physical Checkup" required>
                                </div>

                                <div class="form-group full-width">
                                    <label for="notes" class="form-label">Notes</label>
                                    <textarea id="notes" name="notes" class="form-textarea"
                                        placeholder="Add any relevant notes about this health record..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Visit-specific Fields -->
                        <div class="dynamic-section" id="visit-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-user-md"></i>
                                    Visit Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="doctor" class="form-label">Doctor</label>
                                        <input type="text" id="doctor" name="doctor" class="form-input"
                                            placeholder="e.g., Dr. Sarah Smith, MD">
                                    </div>

                                    <div class="form-group">
                                        <label for="location" class="form-label">Location</label>
                                        <input type="text" id="location" name="location" class="form-input"
                                            placeholder="e.g., Primary Care Clinic A">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Medication-specific Fields -->
                        <div class="dynamic-section" id="medication-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-pills"></i>
                                    Medication Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="medication_name" class="form-label">Medication Name</label>
                                        <input type="text" id="medication_name" name="medication_name"
                                            class="form-input" placeholder="e.g., Lisinopril">
                                    </div>

                                    <div class="form-group">
                                        <label for="dosage" class="form-label">Dosage</label>
                                        <input type="text" id="dosage" name="dosage" class="form-input"
                                            placeholder="e.g., 10mg">
                                    </div>

                                    <div class="form-group">
                                        <label for="frequency" class="form-label">Frequency</label>
                                        <input type="text" id="frequency" name="frequency" class="form-input"
                                            placeholder="e.g., Daily">
                                    </div>

                                    <div class="form-group">
                                        <label for="prescribing_doctor" class="form-label">Prescribing Doctor</label>
                                        <input type="text" id="prescribing_doctor" name="prescribing_doctor"
                                            class="form-input" placeholder="e.g., Dr. Michael Chang">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Lab-specific Fields -->
                        <div class="dynamic-section" id="lab-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-flask"></i>
                                    Lab Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="lab_name" class="form-label">Lab Name</label>
                                        <input type="text" id="lab_name" name="lab_name" class="form-input"
                                            placeholder="e.g., City General Labs">
                                    </div>

                                    <div class="form-group">
                                        <label for="test_type" class="form-label">Test Type</label>
                                        <input type="text" id="test_type" name="test_type" class="form-input"
                                            placeholder="e.g., A1C and Cholesterol Panel">
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="results" class="form-label">Results Summary</label>
                                        <textarea id="results" name="results" class="form-textarea"
                                            placeholder="Enter key results and findings..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Imaging-specific Fields -->
                        <div class="dynamic-section" id="imaging-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-x-ray"></i>
                                    Imaging Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="imaging_type" class="form-label">Imaging Type</label>
                                        <input type="text" id="imaging_type" name="imaging_type" class="form-input"
                                            placeholder="e.g., X-Ray, MRI, CT Scan">
                                    </div>

                                    <div class="form-group">
                                        <label for="body_part" class="form-label">Body Part</label>
                                        <input type="text" id="body_part" name="body_part" class="form-input"
                                            placeholder="e.g., Right Ankle">
                                    </div>

                                    <div class="form-group">
                                        <label for="imaging_center" class="form-label">Imaging Center</label>
                                        <input type="text" id="imaging_center" name="imaging_center" class="form-input"
                                            placeholder="e.g., Advanced Radiology Center">
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="findings" class="form-label">Findings</label>
                                        <textarea id="findings" name="findings" class="form-textarea"
                                            placeholder="Enter imaging findings and interpretation..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Allergy-specific Fields -->
                        <div class="dynamic-section" id="allergy_report-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-allergies"></i>
                                    Allergy Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="allergen" class="form-label">Allergen</label>
                                        <input type="text" id="allergen" name="allergen" class="form-input"
                                            placeholder="e.g., Penicillin">
                                    </div>

                                    <div class="form-group">
                                        <label for="reaction" class="form-label">Reaction</label>
                                        <input type="text" id="reaction" name="reaction" class="form-input"
                                            placeholder="e.g., Severe rash">
                                    </div>

                                    <div class="form-group">
                                        <label for="severity" class="form-label">Severity</label>
                                        <select id="severity" name="severity" class="form-select">
                                            <option value="">Select severity</option>
                                            <option value="Mild">Mild</option>
                                            <option value="Moderate">Moderate</option>
                                            <option value="Severe">Severe</option>
                                            <option value="Life-threatening">Life-threatening</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="diagnosis_date" class="form-label">Diagnosis Date</label>
                                        <input type="date" id="diagnosis_date" name="diagnosis_date" class="form-input">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Condition-specific Fields -->
                        <div class="dynamic-section" id="condition-section">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-stethoscope"></i>
                                    Condition Details
                                </h3>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="condition_name" class="form-label">Condition Name</label>
                                        <input type="text" id="condition_name" name="condition_name" class="form-input"
                                            placeholder="e.g., Hypertension">
                                    </div>

                                    <div class="form-group">
                                        <label for="diagnosis_date_condition" class="form-label">Diagnosis Date</label>
                                        <input type="date" id="diagnosis_date_condition" name="diagnosis_date_condition"
                                            class="form-input">
                                    </div>

                                    <div class="form-group">
                                        <label for="status" class="form-label">Status</label>
                                        <select id="status" name="status" class="form-select">
                                            <option value="">Select status</option>
                                            <option value="Active">Active</option>
                                            <option value="In remission">In remission</option>
                                            <option value="Resolved">Resolved</option>
                                            <option value="Chronic">Chronic</option>
                                        </select>
                                    </div>

                                    <div class="form-group full-width">
                                        <label for="treatment_plan" class="form-label">Treatment Plan</label>
                                        <textarea id="treatment_plan" name="treatment_plan" class="form-textarea"
                                            placeholder="Describe the treatment plan or management approach..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Document Upload -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-file-upload"></i>
                                Document Attachment
                            </h3>

                            <div class="file-upload" id="fileUploadArea">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Drag & drop files here or click to browse</p>
                                <small>Supports PDF, JPG, PNG files (Max: 10MB)</small>
                                <input type="file" id="file_input" class="file-input" accept=".pdf,.jpg,.jpeg,.png">
                            </div>

                            <div class="file-preview" id="filePreview">
                                <!-- File preview will be inserted here -->
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="resetBtn">
                                <i class="fas fa-redo"></i>
                                Reset Form
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Save Health Record
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Record Type Selection
            const recordTypeOptions = document.querySelectorAll('.record-type-option');
            const recordTypeInput = document.getElementById('record_type');
            const dynamicSections = document.querySelectorAll('.dynamic-section');

            recordTypeOptions.forEach(option => {
                option.addEventListener('click', function () {
                    // Remove selected class from all options
                    recordTypeOptions.forEach(opt => opt.classList.remove('selected'));

                    // Add selected class to clicked option
                    this.classList.add('selected');

                    // Set the record type value
                    const recordType = this.getAttribute('data-type');
                    recordTypeInput.value = recordType;

                    // Hide all dynamic sections
                    dynamicSections.forEach(section => {
                        section.classList.remove('active');
                    });

                    // Show the relevant section
                    const targetSection = document.getElementById(`${recordType.toLowerCase()}-section`);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });

            // File Upload Handling
            const fileUploadArea = document.getElementById('fileUploadArea');
            const fileInput = document.getElementById('file_input');
            const filePreview = document.getElementById('filePreview');

            fileUploadArea.addEventListener('click', function () {
                fileInput.click();
            });

            fileUploadArea.addEventListener('dragover', function (e) {
                e.preventDefault();
                this.style.borderColor = 'var(--color-blue)';
                this.style.backgroundColor = 'var(--color-light-blue)';
            });

            fileUploadArea.addEventListener('dragleave', function () {
                this.style.borderColor = '#ddd';
                this.style.backgroundColor = 'var(--color-white)';
            });

            fileUploadArea.addEventListener('drop', function (e) {
                e.preventDefault();
                this.style.borderColor = '#ddd';
                this.style.backgroundColor = 'var(--color-white)';

                if (e.dataTransfer.files.length) {
                    handleFileSelection(e.dataTransfer.files[0]);
                }
            });

            fileInput.addEventListener('change', function () {
                if (this.files.length) {
                    handleFileSelection(this.files[0]);
                }
            });

            function handleFileSelection(file) {
                // Validate file type and size
                const validTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
                const maxSize = 10 * 1024 * 1024; // 10MB

                if (!validTypes.includes(file.type)) {
                    alert('Please select a PDF, JPG, or PNG file.');
                    return;
                }

                if (file.size > maxSize) {
                    alert('File size must be less than 10MB.');
                    return;
                }

                // Display file preview
                filePreview.innerHTML = `
                    <div class="file-item">
                        <div class="file-info">
                            <i class="fas fa-file-pdf file-icon"></i>
                            <span class="file-name">${file.name}</span>
                        </div>
                        <button type="button" class="file-remove" id="removeFile">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;

                filePreview.classList.add('active');

                // Add remove file functionality
                document.getElementById('removeFile').addEventListener('click', function () {
                    filePreview.classList.remove('active');
                    fileInput.value = '';
                });
            }

            // Form Submission
            document.getElementById('healthRecordForm').addEventListener('submit', function (e) {
                e.preventDefault();

                // Validate required fields
                if (!recordTypeInput.value) {
                    alert('Please select a record type.');
                    return;
                }

                // Collect form data
                const formData = new FormData(this);

                // In a real app, you would send this to your backend
                // For demo purposes, we'll just show the collected data
                const formObject = {};
                for (let [key, value] of formData.entries()) {
                    formObject[key] = value;
                }

                // Add file info if available
                if (fileInput.files.length) {
                    formObject.file_name = fileInput.files[0].name;
                    formObject.file_type = fileInput.files[0].type;
                    formObject.file_size = fileInput.files[0].size;
                }

                console.log('Form data:', formObject);

                // Show success message
                alert('Health record saved successfully! In a real app, this would be saved to the database.');

                // Reset form
                this.reset();
                recordTypeOptions.forEach(opt => opt.classList.remove('selected'));
                dynamicSections.forEach(section => section.classList.remove('active'));
                filePreview.classList.remove('active');
            });

            // Reset Form
            document.getElementById('resetBtn').addEventListener('click', function () {
                if (confirm('Are you sure you want to reset the form? All entered data will be lost.')) {
                    document.getElementById('healthRecordForm').reset();
                    recordTypeOptions.forEach(opt => opt.classList.remove('selected'));
                    dynamicSections.forEach(section => section.classList.remove('active'));
                    filePreview.classList.remove('active');
                }
            });

            // Cancel Button
            document.getElementById('cancelBtn').addEventListener('click', function () {
                if (confirm('Are you sure you want to cancel? Any unsaved changes will be lost.')) {
                    window.location.href = 'dashboard.html';
                }
            });

            // Set today's date as default for event date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('event_date').value = today;
        });
    </script>
</body>

</html>